# Illustrating Classic Brazilian Books using a Text-To-Image Diffusion Model

This repository contains the code and selected outputs for the project on using Latent Diffusion Modeling (LDM) to generate illustrations for classic Brazilian literary works. The approach leverages the Stable Diffusion XL model to create visual interpretations of scenes, characters, and settings from the books.

## Contents

- `gen_images.py`: Python script to generate images using the Stable Diffusion XL base and refiner models.
- `Used_prompts.pdf`: A PDF file listing all the prompts used for generating images, including excerpts from the books that inspired each prompt.
- `Selected Images/`: A folder containing a curated selection of images generated by the model, organized by book and prompt. These images were considered for inclusion in the paper. Due to space constraints, the full dataset (around 10,500 images) is not included here but can be made available upon request.

## Getting Started

### Prerequisites

To run the code in this repository, you will need:

1. **Python 3.8+**
2. **CUDA-Compatible GPU**: Required for accelerated inference with PyTorch.
3. **Python Libraries**:
   - `torch`: For running deep learning models. Make sure to install the CUDA-compatible version.
   - `diffusers`: For Stable Diffusion model pipelines.
   - `Pillow`: For image processing.

You can install the necessary Python packages using the following command:

```bash
pip install torch diffusers pillow
```

### Running the Code

1. **Download the Models**

   The code uses two pretrained models from Stability AI:
   - `stabilityai/stable-diffusion-xl-base-1.0`
   - `stabilityai/stable-diffusion-xl-refiner-1.0`

   Make sure you have enough disk space and a stable internet connection to download the models.

2. **Configure the Script**

   The script `gen_images.py` generates images based on a list of prompts related to scenes from the books. It performs inference in two stages:
   - **Base Image Generation**: Uses the base model to create initial images.
   - **Image Refinement**: Utilizes the refiner model to enhance image quality.

   Modify the `lista_de_prompts` variable if you wish to use different prompts.

3. **Run the Script**

   Execute the script to generate images. The images will be saved in the specified output directory (`imgs_geradas_sertoes/`), as an example.

   ```bash
   python gen_images.py
   ```

   Note: The script generates 300 images for each prompt.

## Project Description

The goal of this project is to explore how LDM can be used to visually illustrate classic Brazilian literature. We selected seven public domain books, each with vivid descriptions, and generated thousands of images to depict their settings and characters. We refined the generated images to ensure they aligned well with the texts and curated a selection of the best results.

### Books Included

The selected literary works are from prominent Brazilian authors and include:
- *Senhora* by José de Alencar
- *O Cortiço* by Aluísio Azevedo
- *A Viúva Simões* by Júlia Lopes de Almeida
- *Dom Casmurro* by Machado de Assis
- *Horto* by Auta de Souza
- *Os Sertões* by Euclides da Cunha
- *O Triste Fim de Policarpo Quaresma* by Lima Barreto

## Contact

For questions, suggestions, or requests for the full image dataset, please contact Felipe Mahlow at [felipe.mahlow@gmail.com](mailto:felipe.mahlow@gmail.com).
